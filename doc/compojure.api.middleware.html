<!DOCTYPE html>
<html><head><meta charset="UTF-8"><link href="css/default.css" rel="stylesheet" type="text/css"><title>compojure.api.middleware documentation</title></head><body><header><section class="title"><h1><a href="index.html">Compojure-api Api Documentation</a></h1></section><small>Version: 0.21.0-SNAPSHOT</small></header><section class="container"><div class="sidebar" id="namespaces"><h3><a href="index.html"><span class="inner">Namespaces</span></a></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>compojure</span></div></div></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>api</span></div></div></li><li class="depth-3 branch"><a href="compojure.api.common.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>common</span></div></a></li><li class="depth-3 branch"><a href="compojure.api.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-3 branch"><a href="compojure.api.legacy.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>legacy</span></div></a></li><li class="depth-3 branch"><a href="compojure.api.main.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>main</span></div></a></li><li class="depth-3 branch"><a href="compojure.api.meta.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>meta</span></div></a></li><li class="depth-3 branch current"><a href="compojure.api.middleware.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>middleware</span></div></a></li><li class="depth-3 branch"><a href="compojure.api.routes.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>routes</span></div></a></li><li class="depth-3 branch"><a href="compojure.api.swagger.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>swagger</span></div></a></li><li class="depth-3 branch"><a href="compojure.api.sweet.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>sweet</span></div></a></li><li class="depth-3"><a href="compojure.api.upload.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>upload</span></div></a></li></ul></div><section class="namespace-docs" id="content"><h2 class="anchor" id="top">compojure.api.middleware</h2><div class="doc"><div class="markdown"></div></div><div class="public anchor" id="var--.3Emime-types"><h3><a href="#var--.3Emime-types">-&gt;mime-types</a></h3><div class="usage"><code>(-&gt;mime-types formats)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="http://github.com/metosin/compojure-api/blob/master/src/compojure/api/middleware.clj#L87">view source</a></div></div><div class="public anchor" id="var-api-middleware"><h3><a href="#var-api-middleware">api-middleware</a></h3><div class="usage"><code>(api-middleware handler &amp; [options])</code></div><div class="doc"><div class="markdown"><p>Opinionated chain of middlewares for web apis. Takes options-map, with namespaces options for the used middlewares (see middlewares for full details on options):</p>
<ul>
  <li><strong>:exceptions</strong> for <em>compojure.api.middleware/wrap-exceptions</em>
  <ul>
    <li><strong>:exception-handler</strong> function to handle uncaught exceptions</li>
  </ul></li>
  <li><strong>:validation-errors</strong> for <em>ring.swagger.middleware/wrap-validation-errors</em>
  <ul>
    <li><strong>:error-handler</strong> function to handle ring-swagger schema exceptions</li>
    <li><strong>:catch-core-errors?</strong> whether to catch also <code>:schema.core/errors</code></li>
  </ul></li>
  <li><strong>:format</strong> for ring-middleware-format middlewares
  <ul>
    <li><strong>:formats</strong> sequence of supported formats, e.g. <code>[:json-kw :edn]</code></li>
    <li><strong>:param-opts</strong> for <em>ring.middleware.format-params/wrap-restful-params</em>,  e.g. <code>{:transit-json {:options {:handlers readers}}}</code></li>
    <li><strong>:response-opts</strong> for <em>ring.middleware.format-params/wrap-restful-response</em>,  e.g. <code>{:transit-json {:handlers writers}}</code></li>
  </ul></li>
  <li><strong>:ring-swagger</strong> options for ring-swagger&rsquo;s swagger-json method.  e.g. <code>{:ignore-missing-mappings? true}</code></li>
</ul></div></div><div class="src-link"><a href="http://github.com/metosin/compojure-api/blob/master/src/compojure/api/middleware.clj#L125">view source</a></div></div><div class="public anchor" id="var-api-middleware-defaults"><h3><a href="#var-api-middleware-defaults">api-middleware-defaults</a></h3><div class="usage"></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="http://github.com/metosin/compojure-api/blob/master/src/compojure/api/middleware.clj#L116">view source</a></div></div><div class="public anchor" id="var-default-exception-handler"><h3><a href="#var-default-exception-handler">default-exception-handler</a></h3><div class="usage"><code>(default-exception-handler e)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="http://github.com/metosin/compojure-api/blob/master/src/compojure/api/middleware.clj#L36">view source</a></div></div><div class="public anchor" id="var-get-ring-swagger-options"><h3><a href="#var-get-ring-swagger-options">get-ring-swagger-options</a></h3><div class="usage"><code>(get-ring-swagger-options request)</code></div><div class="doc"><div class="markdown"><p>Extracts ring-swagger options from the request.</p></div></div><div class="src-link"><a href="http://github.com/metosin/compojure-api/blob/master/src/compojure/api/middleware.clj#L65">view source</a></div></div><div class="public anchor" id="var-handle-req-error"><h3><a href="#var-handle-req-error">handle-req-error</a></h3><div class="usage"><code>(handle-req-error e handler req)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="http://github.com/metosin/compojure-api/blob/master/src/compojure/api/middleware.clj#L89">view source</a></div></div><div class="public anchor" id="var-public-resource-routes"><h3><a href="#var-public-resource-routes">public-resource-routes</a></h3><div class="usage"></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="http://github.com/metosin/compojure-api/blob/master/src/compojure/api/middleware.clj#L20">view source</a></div></div><div class="public anchor" id="var-public-resources"><h3><a href="#var-public-resources">public-resources</a></h3><div class="usage"><code>(public-resources handler)</code></div><div class="doc"><div class="markdown"><p>serves public resources for missed requests</p></div></div><div class="src-link"><a href="http://github.com/metosin/compojure-api/blob/master/src/compojure/api/middleware.clj#L24">view source</a></div></div><div class="public anchor" id="var-serializable.3F"><h3><a href="#var-serializable.3F">serializable?</a></h3><div class="usage"><code>(serializable? _ {:keys [body], :as response})</code></div><div class="doc"><div class="markdown"><p>Predicate which return true if the response body is serializable. That is, return type is set by :return compojure-api key or it&rsquo;s a collection.</p></div></div><div class="src-link"><a href="http://github.com/metosin/compojure-api/blob/master/src/compojure/api/middleware.clj#L103">view source</a></div></div><div class="public anchor" id="var-wrap-exceptions"><h3><a href="#var-wrap-exceptions">wrap-exceptions</a></h3><div class="usage"><code>(wrap-exceptions handler &amp; [{:keys [exception-handler], :or {exception-handler default-exception-handler}}])</code></div><div class="doc"><div class="markdown"><p>Catches all exceptions. Accepts the following options:</p><p>:exception-handler - a function to handle the exception. defaults  to default-exception-handler</p></div></div><div class="src-link"><a href="http://github.com/metosin/compojure-api/blob/master/src/compojure/api/middleware.clj#L41">view source</a></div></div><div class="public anchor" id="var-wrap-ring-swagger-options"><h3><a href="#var-wrap-ring-swagger-options">wrap-ring-swagger-options</a></h3><div class="usage"><code>(wrap-ring-swagger-options handler options)</code></div><div class="doc"><div class="markdown"><p>Injects ring-swagger options into the request.</p></div></div><div class="src-link"><a href="http://github.com/metosin/compojure-api/blob/master/src/compojure/api/middleware.clj#L59">view source</a></div></div></section></section></body></html>
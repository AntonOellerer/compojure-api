<!DOCTYPE html>
<html><head><meta charset="UTF-8"><link href="css/default.css" rel="stylesheet" type="text/css"><title>compojure.api.middleware documentation</title></head><body><header><section class="title"><h1><a href="index.html">Compojure-api Api Documentation</a></h1></section><small>Version: 0.24.5</small></header><section class="container"><div class="sidebar" id="namespaces"><h3><a href="index.html"><span class="inner">Namespaces</span></a></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>compojure</span></div></div></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>api</span></div></div></li><li class="depth-3 branch"><a href="compojure.api.common.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>common</span></div></a></li><li class="depth-3 branch"><a href="compojure.api.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-3 branch"><a href="compojure.api.exception.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>exception</span></div></a></li><li class="depth-3 branch"><a href="compojure.api.legacy.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>legacy</span></div></a></li><li class="depth-3 branch"><a href="compojure.api.main.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>main</span></div></a></li><li class="depth-3 branch"><a href="compojure.api.meta.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>meta</span></div></a></li><li class="depth-3 branch current"><a href="compojure.api.middleware.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>middleware</span></div></a></li><li class="depth-3 branch"><a href="compojure.api.routes.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>routes</span></div></a></li><li class="depth-3 branch"><a href="compojure.api.swagger.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>swagger</span></div></a></li><li class="depth-3 branch"><a href="compojure.api.sweet.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>sweet</span></div></a></li><li class="depth-3"><a href="compojure.api.upload.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>upload</span></div></a></li></ul></div><section class="namespace-docs" id="content"><h2 class="anchor" id="top">compojure.api.middleware</h2><div class="doc"><div class="markdown"></div></div><div class="public anchor" id="var--.3Emime-types"><h3><a href="#var--.3Emime-types">-&gt;mime-types</a></h3><div class="usage"><code>(-&gt;mime-types formats)</code></div><div class="doc"><div class="markdown"></div></div></div><div class="public anchor" id="var-api-middleware"><h3><a href="#var-api-middleware">api-middleware</a></h3><div class="usage"><code>(api-middleware handler &amp; [options])</code></div><div class="doc"><div class="markdown"><p>Opinionated chain of middlewares for web apis. Takes options-map, with namespaces options for the used middlewares (see middlewares for full details on options):</p>
<ul>
  <li><p><strong>:exceptions</strong> for <em>compojure.api.middleware/wrap-exceptions</em></p>
  <ul>
    <li><strong>:handlers</strong> Map of error handlers for different exception types, type refers to <code>:type</code> key in ExceptionInfo data.  An error handler is a function of exception, ExceptionInfo data and request to response.  Default:  {:compojure.api.exception/request-validation compojure.api.exception/request-validation-handler  :compojure.api.exception/request-parsing compojure.api.exception/request-parsing-handler  :compojure.api.exception/response-validation compojure.api.exception/response-validation-handler  :compojure.api.exception/default compojure.api.exception/safe-handler}</li>
  </ul>
  <pre><code>                           Note: Because the handlers are merged into default handlers map, to disable default handler you
                           need to provide `nil` value as handler.

                           Note: To catch Schema errors use {:schema.core/error compojure.api.exception/schema-error-handler}

                           Note: Adding an alias for exception namespace makes it easier to define these options.
</code></pre></li>
  <li><p><strong>:format</strong> for ring-middleware-format middlewares</p>
  <ul>
    <li><strong>:formats</strong> sequence of supported formats, e.g. <code>[:json-kw :edn]</code></li>
    <li><strong>:params-opts</strong> for <em>ring.middleware.format-params/wrap-restful-params</em>,  e.g. <code>{:transit-json {:handlers readers}}</code></li>
    <li><strong>:response-opts</strong> for <em>ring.middleware.format-params/wrap-restful-response</em>,  e.g. <code>{:transit-json {:handlers writers}}</code></li>
  </ul></li>
  <li><p><strong>:ring-swagger</strong> options for ring-swagger&rsquo;s swagger-json method.  e.g. <code>{:ignore-missing-mappings? true}</code></p></li>
  <li><p><strong>:coercion</strong> A function from request-&gt;type-&gt;coercion-matcher, used  in endpoint coercion for :json, :query and :response.  Defaults to <code>compojure.api.middleware/default-coercion-matchers</code></p></li>
  <li><p><strong>:components</strong> Components which should be accessible to handlers using  :components restructuring. (If you are using defapi,  you might want to take look at using wrap-components  middleware manually.)</p></li>
</ul></div></div></div><div class="public anchor" id="var-api-middleware-defaults"><h3><a href="#var-api-middleware-defaults">api-middleware-defaults</a></h3><div class="usage"></div><div class="doc"><div class="markdown"></div></div></div><div class="public anchor" id="var-CoercionType"><h3><a href="#var-CoercionType">CoercionType</a></h3><div class="usage"></div><div class="doc"><div class="markdown"></div></div></div><div class="public anchor" id="var-default-coercion-matchers"><h3><a href="#var-default-coercion-matchers">default-coercion-matchers</a></h3><div class="usage"></div><div class="doc"><div class="markdown"></div></div></div><div class="public anchor" id="var-get-coercion-matcher-provider"><h3><a href="#var-get-coercion-matcher-provider">get-coercion-matcher-provider</a></h3><div class="usage"><code>(get-coercion-matcher-provider request)</code></div><div class="doc"><div class="markdown"></div></div></div><div class="public anchor" id="var-get-components"><h3><a href="#var-get-components">get-components</a></h3><div class="usage"><code>(get-components req)</code></div><div class="doc"><div class="markdown"></div></div></div><div class="public anchor" id="var-get-options"><h3><a href="#var-get-options">get-options</a></h3><div class="usage"><code>(get-options request)</code></div><div class="doc"><div class="markdown"><p>Extracts compojure-api options from the request.</p></div></div></div><div class="public anchor" id="var-handle-req-error"><h3><a href="#var-handle-req-error">handle-req-error</a></h3><div class="usage"><code>(handle-req-error e handler request)</code></div><div class="doc"><div class="markdown"></div></div></div><div class="public anchor" id="var-no-response-coercion"><h3><a href="#var-no-response-coercion">no-response-coercion</a></h3><div class="usage"></div><div class="doc"><div class="markdown"></div></div></div><div class="public anchor" id="var-public-resource-routes"><h3><a href="#var-public-resource-routes">public-resource-routes</a></h3><div class="usage"></div><div class="doc"><div class="markdown"></div></div></div><div class="public anchor" id="var-public-resources"><h3><a href="#var-public-resources">public-resources</a></h3><div class="usage"><code>(public-resources handler)</code></div><div class="doc"><div class="markdown"><p>serves public resources for missed requests</p></div></div></div><div class="public anchor" id="var-rethrow-exceptions.3F"><h3><a href="#var-rethrow-exceptions.3F">rethrow-exceptions?</a></h3><div class="usage"></div><div class="doc"><div class="markdown"></div></div></div><div class="public anchor" id="var-serializable.3F"><h3><a href="#var-serializable.3F">serializable?</a></h3><div class="usage"><code>(serializable? _ {:keys [body], :as response})</code></div><div class="doc"><div class="markdown"><p>Predicate which returns true if the response body is serializable. That is, return type is set by :return compojure-api key or it&rsquo;s a collection.</p></div></div></div><div class="public anchor" id="var-wrap-coercion"><h3><a href="#var-wrap-coercion">wrap-coercion</a></h3><div class="usage"><code>(wrap-coercion handler coercion)</code></div><div class="doc"><div class="markdown"></div></div></div><div class="public anchor" id="var-wrap-components"><h3><a href="#var-wrap-components">wrap-components</a></h3><div class="usage"><code>(wrap-components handler components)</code></div><div class="doc"><div class="markdown"><p>Assoc given components to the request.</p></div></div></div><div class="public anchor" id="var-wrap-exceptions"><h3><a href="#var-wrap-exceptions">wrap-exceptions</a></h3><div class="usage"><code>(wrap-exceptions handler {:keys [handlers]})</code></div><div class="doc"><div class="markdown"><p>Catches all exceptions and delegates to correct error handler according to :type of Exceptions - <strong>:handlers</strong> - a map from exception type to handler  - <strong>:compojure.api.exception/default</strong> - Handler used when exception type doesn&rsquo;t match other handler,  by default prints stack trace.</p></div></div></div><div class="public anchor" id="var-wrap-options"><h3><a href="#var-wrap-options">wrap-options</a></h3><div class="usage"><code>(wrap-options handler options)</code></div><div class="doc"><div class="markdown"><p>Injects compojure-api options into the request.</p></div></div></div></section></section></body></html>